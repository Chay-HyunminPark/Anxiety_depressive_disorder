---
title: "Are we living in a depressive society?"
subtitle: "Trends in symptoms of depressive disorder in the US population from May 2020 to March 2024"
author: Chay Park
thanks: "Code and data are available at: https://github.com/Chay-HyunminPark/Anxiety_depressive_disorder."
date: today
date-format: long
abstract: "This study explores how socio-cultural factors like age, sex, race/ethnicity, and education level influenced depressive disorder in the U.S. during and after the COVID-19 pandemic, analyzing data from 2020 to 2024. Using advanced statistical methods in R, it uncovered significant variations in mental health impacts across different demographic groups. The research reveals a complex relationship between socio-cultural factors and mental health, highlighting the increased vulnerability of certain populations during global crises. The findings contribute to the development of targeted public health measures to alleviate mental health issues amid and following pandemics, enhancing our understanding of the impact of socio-cultural factors on mental well-being in times of crisis."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

# Load necessary libraries for the paper
library(tidyverse)
library(lubridate)
library(arrow)
library(here)
library(ggrepel)  # For better label placement
library(extrafont)
library(ggplot2)
library(gridExtra)

```


# Introduction

Depression and anxiety are not only prevalent but escalating issues in the modern world, affecting individuals across the globe regardless of demographic factors (World Health Organization, 2021). These mental health challenges have been further exacerbated by the COVID-19 pandemic, which led to widespread social and economic upheaval (Brooks et al., 2020). While various studies have explored the impact of the pandemic on mental health, there remains a significant gap in understanding the nuanced interactions between socio-cultural factors and the prevalence of anxiety and depressive disorders during this period (Pfefferbaum & North, 2020).

This paper addresses this gap by analyzing data from the U.S. Census Bureau's Household Pulse Survey, initiated in response to the pandemic to assess its effects on American households, including mental wellness (U.S. Census Bureau, 2020). Our analysis focuses on the correlation between the prevalence of anxiety or depressive disorders and socio-cultural factors such as age, sex, race/ethnicity, and education level during the pandemic and post pandemic years of 2020 to 2024. Specifically, the estimand of this study is the difference in the rates of symptoms of anxiety or depressive disorders across individuals, correlated with socio-cultural factors including age, sex, race/ethnicity, and education level.

Employing a quantitative methodology, this paper utilizes R (R Core Team 2020) for analysis. We utilized packages like ggplot2 (Wickham et al., 2016) and gridExtra (Murrell, 2021) for data analysis and visualization. Our findings reveal significant trends and disparities in the rates of anxiety and depressive disorders across different socio-cultural groups, highlighting the intricate relationship between these factors and mental health outcomes during the pandemic.

The importance of this research lies in its potential to inform public health policies and interventions, aiming to mitigate the adverse effects of such global crises on mental health (Xiong et al., 2020). By understanding the specific socio-cultural factors that contribute to increased vulnerability to anxiety and depressive disorders, targeted strategies can be developed to support affected populations more effectively.

The paper is structured to first present the trend analysis of anxiety and depressive disorder rates in the U.S. from 2020 to 2024, followed by an examination of how these rates vary across different demographic groups. Subsequent sections delve into the statistical methods and results for each research question, culminating in a discussion that synthesizes the findings and explores their broader implications for mental health research and policy. The conclusion summarizes the key insights, acknowledges the limitations of the study, and suggests avenues for future research.

The study focuses on answering the following research questions:

* What is the trend in US anxiety and depressive disorder rates from 2020 to 2024?

* How do depressive rates vary across different age groups?

* How do depressive rates differ based on race and ethnicity?

* How do depressive rates differ based on sex?

* How do adepressive rates differ based on education level?

* Is there codependency of social connection on one's depression level?  

# Data {#sec-data}

## Methodology

## Features

# Results

## Trend in US Anxiety and Depressive Disorder Rates

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: fig-andtrend-graph
#| fig-cap: "Trend in US Anxiety and Depressive Disorder Rates"

# Load the fonts
loadfonts(device = "win")

# Define the path to the data file and load it
data <- read_parquet(file = here::here("outputs/data/Overall_trends.parquet"))

# Filter the dataset for the specified symptoms
filtered_data <- data %>%
  filter(Indicator %in% c('Symptoms of Depressive Disorder', 
                          'Symptoms of Anxiety Disorder', 
                          'Symptoms of Anxiety Disorder or Depressive Disorder')) %>%
  mutate(Indicator = factor(Indicator, levels = c('Symptoms of Anxiety Disorder or Depressive Disorder',
                                                  'Symptoms of Anxiety Disorder',
                                                  'Symptoms of Depressive Disorder')))

# Ensure that 'Time.Period.End.Date' is a Date object
filtered_data$Date <- as.Date(filtered_data$Date, format = "%Y-%m-%d")

# Define the specific dates for the x-axis scale
specific_dates <- as.Date(c("2020-05-05", "2020-09-14", "2021-01-05", 
                            "2021-05-10", "2021-09-13", "2022-01-10", 
                            "2022-05-09", "2022-09-13", "2023-01-16",
                            "2023-05-08", "2023-09-04", "2024-01-08"))

# Plotting the line graph
p <- ggplot(filtered_data, aes(x = Date, y = Value, group = Indicator, color = Indicator)) +
  geom_line() +
  geom_hline(yintercept = seq(10, 45, by = 5), color = "lightgrey") +
  scale_x_date(breaks = specific_dates, date_labels = "%Y-%m") +
  labs(x = NULL,
       y = "Symptom Rates (%)") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, family = "Times"),
        axis.text.y = element_text(family = "Times"),
        axis.title.x = element_text(family = "Times"),
        axis.title.y = element_text(family = "Times"),
        legend.position = "bottom",
        legend.box = "vertical",
        legend.direction = "vertical",
        plot.margin = unit(c(1, 1, 1, 1), "cm"))

# Display the plot
print(p)

```

Both Anxiety and Depressive Disorder showing the similar trends over the period. 

## Trends in Depressive Disorder Rates by Population Subgroup

### Population subgroup by age

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: fig-ageandtrend-graph
#| fig-cap: "Depressive Disorder Trend by Population Subgroup by Age"

# Load necessary libraries
library(tidyverse)
library(arrow)
library(here)
library(ggrepel)
library(extrafont)

# Load the fonts
loadfonts(device = "win")

# Define the path to the data file and load it
data <- read_parquet(file = here::here("outputs/data/Age_subgroup_trends.parquet"))

# Convert 'Date' column to Date format if it's not already
data$Date <- as.Date(data$Date, format = "%Y-%m-%d")

# Define the specific dates for the x-axis scale
specific_dates <- as.Date(c("2020-05-05", "2020-09-14", "2021-01-05", 
                            "2021-05-10", "2021-09-13", "2022-01-10", 
                            "2022-05-09", "2022-09-13", "2023-01-16",
                            "2023-05-08", "2023-09-04", "2024-01-08"))

# Filter the data to get the rows for the specific date to label
label_date <- as.Date("2022-01-10")
label_data <- data %>%
  filter(Date == label_date)

# Plotting the line graph
p <- ggplot(data, aes(x = Date, y = Value, group = Subgroup, color = Subgroup)) +
  geom_line() +
  geom_text_repel(data = label_data, aes(label = Subgroup, x = Date, y = Value), 
                  family = "Times", color = "black",
                  size = 3,  # Smaller text size
                  arrow = arrow(type = "closed", length = unit(0.02, "inches"), angle = 15),
                  box.padding = unit(0.5, "lines"),
                  point.padding = unit(0.5, "lines")) +
  geom_hline(yintercept = seq(0, 50, by = 10), color = "lightgrey") +
  scale_x_date(breaks = specific_dates, date_labels = "%Y-%m") +
  labs(x = NULL, y = "Symptom Rates (%)") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, family = "Times"),
        axis.text.y = element_text(family = "Times"),
        axis.title.x = element_text(family = "Times"),
        axis.title.y = element_text(family = "Times"),
        legend.position = "none",
        plot.margin = unit(c(1, 1, 1, 1), "cm"))

# Display the plot
print(p)

```


### Population subgroup by sex

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: fig-sexandtrend-graph
#| fig-cap: "Depressive Disorder Trend by Population Subgroup by Sex"

# Define the path to the data file and load it
data <- read_parquet(file = here::here("outputs/data/Sex_subgroup_trends.parquet"))

# Convert 'Date' column to Date format if it's not already
data$Date <- as.Date(data$Date, format = "%Y-%m-%d")

# Define the specific dates for the x-axis scale
specific_dates <- as.Date(c("2020-05-05", "2020-09-14", "2021-01-05", 
                            "2021-05-10", "2021-09-13", "2022-01-10", 
                            "2022-05-09", "2022-09-13", "2023-01-16",
                            "2023-05-08", "2023-09-04", "2024-01-08"))

# Filter the data to get the rows for the specific date to label
label_date <- as.Date("2022-01-10")
label_data <- data %>%
  filter(Date == label_date)

# Plotting the line graph
p <- ggplot(data, aes(x = Date, y = Value, group = Subgroup, color = Subgroup)) +
  geom_line() +
  geom_hline(yintercept = seq(0, 40, by = 5), color = "lightgrey") +
  scale_x_date(breaks = specific_dates, date_labels = "%Y-%m") +
  labs(x = NULL, y = "Symptom Rates (%)") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, family = "Times"),
        axis.text.y = element_text(family = "Times"),
        axis.title.x = element_text(family = "Times"),
        axis.title.y = element_text(family = "Times"),
        legend.position = "none",  # Remove the separate legend
        plot.margin = unit(c(1, 1, 1, 1), "cm"))

p + geom_text_repel(
  data = label_data,
  aes(label = Subgroup),
  nudge_x = 0,  # Adjust nudge_x and nudge_y to correctly position the labels
  nudge_y = 0,
  direction = "y",
  color = "black",
  family = "Times"
)

```

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: fig-raceandtrend-graph
#| fig-cap: "Depressive Disorder Trend by Population Subgroup by Race"

# Load necessary libraries
library(tidyverse)
library(arrow)
library(here)
library(ggrepel)
library(extrafont)

# Load the fonts
loadfonts(device = "win")

# Define the path to the data file and load it
data <- read_parquet(file = here::here("outputs/data/Race_subgroup_trends.parquet"))

# Convert 'Date' column to Date format if it's not already
data$Date <- as.Date(data$Date, format = "%Y-%m-%d")

# Rename the subgroup values
data$Subgroup <- recode(data$Subgroup,
                        "Hispanic or Latino" = "Hispanic",
                        "Non-Hispanic Asian, single race" = "Asian",
                        "Non-Hispanic Black, single race" = "African American",
                        "Non-Hispanic White, single race" = "Caucasian",
                        "Non-Hispanic, other races and multiple races" = "Other")

# Define the specific dates for the x-axis scale
specific_dates <- as.Date(c("2020-05-05", "2020-09-14", "2021-01-05", 
                            "2021-05-10", "2021-09-13", "2022-01-10", 
                            "2022-05-09", "2022-09-13", "2023-01-16",
                            "2023-05-08", "2023-09-04", "2024-01-08"))

# Filter the data to get the rows for the specific date to label
label_date <- as.Date("2022-01-10")
label_data <- data %>%
  filter(Date == label_date)

# Plotting the line graph
p <- ggplot(data, aes(x = Date, y = Value, group = Subgroup, color = Subgroup)) +
  geom_line() +
  geom_text_repel(data = label_data, aes(label = Subgroup, x = Date, y = Value), 
                  nudge_x = 0, nudge_y = 0, family = "Times", color = "black",
                  size = 3,  # Make label text smaller
                  arrow = arrow(type = "closed", length = unit(0.02, "inches"), ends = "last", angle = 30)) +
  geom_hline(yintercept = seq(0, 40, by = 5), color = "lightgrey") +
  scale_x_date(breaks = specific_dates, date_labels = "%Y-%m") +
  labs(x = NULL, y = "Symptom Rates (%)") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, family = "Times"),
        axis.text.y = element_text(family = "Times"),
        axis.title.x = element_text(family = "Times"),
        axis.title.y = element_text(family = "Times"),
        legend.position = "none",
        plot.margin = unit(c(1, 1, 1, 1), "cm"))

# Display the plot
print(p)

```

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: fig-educandtrend-graph
#| fig-cap: "Depressive Disorder Trend by Population Subgroup by Education"

library(tidyverse)
library(arrow)
library(here)
library(ggrepel)
library(extrafont)

# Load the fonts
loadfonts(device = "win")

# Define the path to the data file and load it
data <- read_parquet(file = here::here("outputs/data/Educ_subgroup_trends.parquet"))

# Convert 'Date' column to Date format if it's not already
data$Date <- as.Date(data$Date, format = "%Y-%m-%d")

# Rename the subgroup values
data$Subgroup <- recode(data$Subgroup,
                        "Bachelor's degree or higher" = "College graduate",
                        "High school diploma or GED" = "High school graduate",
                        "Some college/Associate's degree" = "Some college",
                        "Less than a high school diploma" = "No high school degree")

# Define the specific dates for the x-axis scale
specific_dates <- as.Date(c("2020-05-05", "2020-09-14", "2021-01-05", 
                            "2021-05-10", "2021-09-13", "2022-01-10", 
                            "2022-05-09", "2022-09-13", "2023-01-16",
                            "2023-05-08", "2023-09-04", "2024-01-08"))

# Prepare data for labels
label_data <- data %>%
  group_by(Subgroup) %>%
  summarize(Date = median(Date), Value = median(Value)) %>%
  ungroup()

# Plotting the line graph with adjusted label positions
p <- ggplot(data, aes(x = Date, y = Value, group = Subgroup, color = Subgroup)) +
  geom_line() +
  geom_text_repel(data = label_data, aes(label = Subgroup, x = Date, y = Value), 
                  family = "Times", 
                  size = 3,  # Smaller text size
                  arrow = arrow(type = "closed", length = unit(0.02, "inches"), angle = 30),
                  box.padding = unit(0.5, "lines"),
                  point.padding = unit(0.5, "lines")) +
  geom_hline(yintercept = seq(0, 40, by = 5), color = "lightgrey") +
  scale_x_date(breaks = specific_dates, date_labels = "%Y-%m") +
  labs(x = "Date", y = "Symptom Rates (%)") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, family = "Times"),
        axis.text.y = element_text(family = "Times"),
        axis.title.x = element_text(family = "Times"),
        axis.title.y = element_text(family = "Times"),
        legend.position = "none",
        plot.margin = unit(c(1, 1, 1, 1), "cm"))

print(p)

```
```{r}

# Define the path to the data file and load it
social_data <- read_parquet(file = here::here("outputs/data/Social_Connection.parquet"))

# Filter data for the indicator "Adults who usually or always feel lonely" and "By Age" subgroup
social_age_data <- social_data %>%
  filter(Indicator == "Adults who usually or always feel lonely", Group == "By Age")

# Plot the stacked bar chart
graph_age <- ggplot(social_age_data, aes(x = `Time.Period`, y = Value, fill = Subgroup)) +
  geom_bar(stat = "identity", position = "stack") +
  labs(title = "Adults who usually or always feel lonely - By Age",
       x = NULL,
       y = "Value") +
  theme_minimal()


# Filter data for the indicator "Adults who usually or always feel lonely" and "By Sex" subgroup
social_sex_data <- social_data %>%
  filter(Indicator == "Adults who usually or always feel lonely", Group == "By Sex")

# Plot the stacked bar chart
graph_sex <- ggplot(social_sex_data, aes(x = `Time.Period`, y = Value, fill = Subgroup)) +
  geom_bar(stat = "identity", position = "stack") +
  labs(title = "Adults who usually or always feel lonely - By Sex",
       x = NULL,
       y = "Value") +
  theme_minimal()

# Filter data for the indicator "Adults who usually or always feel lonely" and "By Race/Hispanic ethnicity" subgroup
social_race_data <- social_data %>%
  filter(Indicator == "Adults who usually or always feel lonely", Group == "By Race/Hispanic ethnicity")

# Plot the stacked bar chart
graph_race <- ggplot(social_race_data, aes(x = `Time.Period`, y = Value, fill = Subgroup)) +
  geom_bar(stat = "identity", position = "stack") +
  labs(title = "Adults who usually or always feel lonely - By Race",
       x = NULL,
       y = "Value") +
  theme_minimal()

# Filter data for the indicator "Adults who usually or always feel lonely" and "By Education" subgroup
social_educ_data <- social_data %>%
  filter(Indicator == "Adults who usually or always feel lonely", Group == "By Education")

# Plot the stacked bar chart
graph_educ <- ggplot(social_educ_data, aes(x = `Time.Period`, y = Value, fill = Subgroup)) +
  geom_bar(stat = "identity", position = "stack") +
  labs(title = "Adults who usually or always feel lonely - By Education",
       x = NULL,
       y = "Value") +
  theme_minimal()

# Arrange graphs in single pane
grid.arrange(graph_age, graph_sex, graph_race, graph_educ, nrow = 2, ncol = 2)

```


# Model

## Model set-up


### Model justification


# Discussion

What is done in this paper? 
What is something that we learn about the world? 
What is another thing that we learn about the world? 
What are some weaknesses of what was done? 
What is left to learn or how should we proceed in the future?

## Findings

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Ethical Implication

## Limitation

The survey was designed to meet the goal of accurate and timely weekly estimates. Hence, it was conducted by an internet questionnaire, with invitations to participate sent by email and text message. 

## Future Research


\newpage

\appendix

# Appendix {-}


# Additional data details

# Model details {#sec-model-details}

## Posterior predictive check


## Diagnostics



\newpage


# References

---
nocite: '@*'
---

